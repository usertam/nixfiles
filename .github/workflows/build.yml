name: "Build Image"
on:
  workflow_dispatch:
  push:
    branches:
    - master
jobs:
  build:
    name: Build Image
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: cachix/install-nix-action@v24
      with:
        nix_path: nixpkgs=https://github.com/NixOS/nixpkgs/archive/nixpkgs-unstable.tar.gz
    - name: Build config.system.build.azureImage
      run: |
        nix build .#nixosConfigurations.base.config.system.build.azureImage
    - name: Upload artifact
      uses: actions/upload-artifact@v4
      with:
        path: result/*
